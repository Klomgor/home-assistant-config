## SENSORS / TEMPLATES / OFFICE

# -- xiaomi mi flora --
# soil moisture
- name: 'Plnt Dracaena Trifasciata Soil'
  state: >
    {% if state_attr('plant.office_dracaena_trifasciata', 'problem') | regex_search('moisture low', ignorecase=True) %}
      {# report the moisture unit difference - #}
      {% if is_number(state_attr('plant.office_dracaena_trifasciata', 'moisture') | int) %}
        {% set offset = "%-g" | format(((state_attr('plant.office_dracaena_trifasciata', 'moisture') - 5 | int))) %}
        Soil Moisture Low ({{ offset }})
      {% else %}
        Soil Moisture Low
      {% endif %}
    {% elif state_attr('plant.office_dracaena_trifasciata', 'problem') | regex_search('moisture high', ignorecase=True) %}
      {# report the moisture unit difference + #}
      {% if is_number(state_attr('plant.office_dracaena_trifasciata', 'moisture') | int) %}
        {% set offset = "%+g" | format(((state_attr('plant.office_dracaena_trifasciata', 'moisture') | int) - 50)) %}
        Soil Moisture High ({{ offset }})
      {% else %}
        Soil Moisture High
      {% endif %}
    {% else %}
      Normal
    {% endif %}

# battery state of sonos roam
- name: 'Media Office Roam Battery State'
  unique_id: media_office_roam_battery_state
  device_class: battery
  unit_of_measurement: '%'
  icon: >
    {% if is_state('binary_sensor.media_office_roam_power','on') %}
      mdi:battery-charging
    {% elif states('sensor.media_office_roam_battery') | int(0) < 25 %}
      mdi:battery-low
    {% elif states('sensor.media_office_roam_battery') | int(0) < 75 %}
      mdi:battery-medium
    {% else %}
      mdi:battery-full
    {% endif %}
  attributes:
    Power: >
      {% if is_state('binary_sensor.media_office_room_power','on') %}
        Charging
      {% else %}
        Battery
      {% endif %}
  state: >
    {{ states('sensor.media_office_roam_battery') }}
