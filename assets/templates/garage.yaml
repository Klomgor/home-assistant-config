## TEMPLATES / GARAGE

# -- binary sensors --
- binary_sensor:
    # -- sinopé --
    # heating on/off
    - name: 'HVAC Garage Heating State'
      state: >
        {% if is_number(states('sensor.hvac_garage_heating_demand')) %}
          {{ states('sensor.hvac_garage_heating_demand') | int(default=0) > 0 }}
        {% endif %}

    # -- sonoff --
    # dehumidifier running (via plug)
    - name: 'Garage Dehumidifier State'
      # power reported in watts
      state: >
        {% if is_number(states('sensor.garage_dehumidifier_plug_energy_power')) %}
          {{ (states('sensor.garage_dehumidifier_plug_energy_power') | int(default=0)) > 10 }}
        {% endif %}
    
    # vehicle door open/closed
    - name: 'Garage Vehicle Door Contact State'
      device_class: garage_door
      state: >
        {{ is_state('switch.sw_garagedoorcontact', 'on') }}

# --- sensors ---
- sensor:
    # -- xiaomi aqara --
    # room humidity
    - name: 'Garage Climate Humidity Rounded'
      device_class: humidity
      unit_of_measurement: '%'
      state: > 
        {% if is_number(states('sensor.garage_mean_humidity_calculation')) %}
          {{ states('sensor.garage_mean_humidity_calculation') | int }}
        {% else %}
          {# use previous value if sensor returns unknown #}
          {{ states('sensor.garage_climate_humidity_rounded') }}
        {% endif %}
    
    # fridge temperature
    - name: 'Garage Fridge Temperature 1 Decimal'
      device_class: temperature
      unit_of_measurement: '°C'
      state: >
        {% if is_number(state_attr('sensor.snr_garagefridgeclimate_temperature', 'temperature')) %}
          {{ state_attr('sensor.snr_garagefridgeclimate_temperature', 'temperature') | round(1, default=1) }}
        {% else %}
          {# use previous value if sensor returns unknown #}
          {{ states('sensor.garage_fridge_temperature_1_decimal') }}
        {% endif %}

    # -- sinopé --
    # room temperature
    - name: 'HVAC_GarageThermostat Temperature'
      device_class: temperature
      unit_of_measurement: '°C'
      state: >
        {% if is_number(state_attr('climate.hvac_garagethermostat', 'current_temperature')) %}
          {{ state_attr('climate.hvac_garagethermostat', 'current_temperature') }}
        {% endif %}
