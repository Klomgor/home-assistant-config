## HOUSE

- binary_sensor:
    # -- ecobee --
    # HVAC any equipment running
    - name: 'HVAC Ecobee State'
      state: >
        {{
          state_attr('climate.amazon', 'fan')                       or
          is_state_attr('climate.amazon', 'hvac_action', 'heating') or
          is_state_attr('climate.amazon', 'hvac_action', 'cooling')
        }}

    # HVAC fan on/off (when heating/cooling NOT running)
    - name: 'HVAC Ecobee Fan State'
      state: >
        {{ is_state_attr('climate.amazon', 'hvac_action', 'fan') }}

    # HVAC heating on/off
    - name: 'HVAC Ecobee Heating State'
      state: >
        {{ is_state_attr('climate.amazon', 'hvac_action', 'heating') }}

    # HVAC cooling on/off
    - name: 'HVAC Ecobee Cooling State'
      state: >
        {{ is_state_attr('climate.amazon', 'hvac_action', 'cooling') }}


- sensor:
    # -- ecobee --
    # current_temperature from ecobee
    - name: 'HVAC Ecobee Indoor Average Temperature'
      device_class: temperature
      unit_of_measurement: 'Â°C'
      state: >
        {{ state_attr('climate.amazon', 'current_temperature') }}

    # humidity from ecobee
    - name: 'HVAC Ecobee Indoor Average Humidity'
      device_class: humidity
      unit_of_measurement: '%'
      state: >
        {{ state_attr('climate.amazon', 'current_humidity') | float(2) }}

    # current mean humidity from min_max calculation
    - name: 'Indoor Mean Humidity'
      device_class: humidity
      unit_of_measurement: '%'
      state: >
        {{ states('sensor.indoor_mean_humidity_calculation') | int }}