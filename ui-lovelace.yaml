anchors:
  # alerts (generic)
  alert-style: &alert-style
    card_mod:
      style: |
        :host {
          color: #e63900;
          --card-mod-icon-color: #e63900;
          --secondary-text-color: #aa3300;
        }

  # alerts (plants)
  alert-plant-style: &alert-plant-style
    card_mod:
      style: |
        :host {
          color: #00b32d;
          --card-mod-icon-color: #00b32d;
          --secondary-text-color: #008020;
        }

  # entity header formatting (not used for overivew dashboard)
  entities-header-style: &entities-header-style
    card_mod:
      style: |
        :host .card-header {
          padding: 5px 20px 0px 20px;
          font-size: 1.2em;
          font-weight: bold;
          line-height: 20px;
          display: flex;
          flex-direction: row;
        }
        :host .card-header:before, .card-header:after {
          content: "";
          flex: 1 1;
          border-bottom: 1px solid #505050;
          margin: auto;
        }
        :host .card-header:before {
          margin-right: 10px;
        }
        :host .card-header:after {
          margin-left: 10px;
        }

  entities-overview-header-style: &entities-overview-header-style
    card_mod:
      style: |
        :host .card-header {
          padding: 5px 20px 0px 20px;
          font-size: 1.2em;
          font-weight: bold;
          line-height: 40px;
          display: flex;
          flex-direction: row;
          margin-top: -10px;
        }
        :host .card-header:before, .card-header:after {
          content: "";
          flex: 1 1;
          border-bottom: 1px solid #505050;
          margin: auto;
        }
        :host .card-header:before {
          margin-right: 10px;
        }
        :host .card-header:after {
          margin-left: 10px;
        }

  # entities
  entities-style: &entities-style
    card_mod:
      style: |
        :host .card-content {
          padding: 0px 10px 5px;
        }
        ha-card {
          box-shadow: none;
        }

  # thermostat
  thermostat-style: &thermostat-style
    card_mod:
      style: |
        ha-card {
          --st-font-size-xl: 60px;
          --st-font-size-m: 20px;
          --st-font-size-sensors: 14px;
          --st-spacing: 2px;
        }

  # climate button
  climate-button-style: &climate-button-style
    card_mod:
      style: |
        ha-card {
          box-shadow: none;
          height: 50px;
        }
    styles:
      name:
        - font-size: 11px
      state:
        - font-size: 20px

  # battery state
  battery-state-style: &battery-state-style
    card_mod:
      style: |
        :host .card-header {
          padding: 5px 20px 0px 20px;
          font-size: 1.2em;
          font-weight: bold;
          line-height: 20px;
          display: flex;
          flex-direction: row;
        }
        :host .card-header:before, .card-header:after {
          content: "";
          flex: 1 1;
          border-bottom: 1px solid #505050;
          margin: auto;
        }
        :host .card-header:before {
          margin-right: 10px;
        }
        :host .card-header:after {
          margin-left: 10px;
        }
        :host .card-content {
          padding: 5px 15px 5px 10px;
        }
        :host .entity-spacing {
          margin: 0px 0;
        }
        .icon {
          height: 30px;
        }

  # neutral icon entity
  neutral-icon-entity-style: &neutral-icon-entity-style
    card_mod:
      style: |
        :host {
          --card-mod-icon-color: var(--secondary-text-color)
        }

  # graph button-card style
  graph-button-card-style: &graph-button-card-style
    style: |
      ha-card {
        box-shadow: none;
      }
    styles:
      card:
        - margin: -3px
        - height: 60px
      name:
        - margin: 10px
        - font-size: 11px
      state:
        - margin: -10px
        - font-size: 20px

  # battery state color_gradient
  battery-state-color_gradient: &battery-state-color_gradient
    color_gradient:
      - "#a21c10" # red
      - "#b3b300" # yellow
      - "#24b300" # green

  # mini-graph-card temperature color_thresholds
  temp-graph-color_thresholds: &temp-graph-color_thresholds
    color_thresholds:
      - color: '#a55eea'
        value: -6.9
      - color: '#8854d0'
        value: -3.9
      - color: '#3867d6'
        value: -1.2
      - color: '#4b7bec'
        value: 1.6
      - color: '#2d98da'
        value: 4.3
      - color: '#45aaf2'
        value: 7.1
      - color: '#0fb9b1'
        value: 9.9
      - color: '#2bcbba'
        value: 12.7
      - color: '#20bf6b'
        value: 15.5
      - color: '#26de81'
        value: 18.2
      - color: '#fed330'
        value: 21
      - color: '#f7b731'
        value: 23.8
      - color: '#fd9644'
        value: 26.6
      - color: '#fa8231'
        value: 29.3
      - color: '#fc5c65'
        value: 32.1
      - color: '#eb3b5a'
        value: 35.9


title: Home
custom_header:
  compact_mode: true
views:
  ## ------ OVERVIEW DASHBOARD ------
  - title: Overview
    path: overview
    icon: 'mdi:alert-box-outline'
    theme: google-dark-theme
    badges: []
    cards:
      # devices in state out of normal range
      - type: 'custom:auto-entities'
        show_empty: false
        card:
          type: entities
          title: 'ðŸš¨ Alerts ðŸš¨'
          show_header_toggle: false
          <<: *entities-overview-header-style
        filter:
          include:
            # battery low: zigbee & ble sensors < 25%
            - entity_id: 'sensor.*_battery'
              state: '< 25'
              options:
                secondary_info: last-changed
                icon: 'mdi:battery-alert-variant-outline'
                <<: *alert-style
            # battery low: rtl_433 sensors == on
            - entity_id: 'binary_sensor.snr_*temperature_battery_low'
              state: 'on'
              options:
                secondary_info: last-changed
                icon: 'mdi:battery-alert-variant-outline'
                <<: *alert-style
            # freezer temperature too warm (> -13.9 Â°C)
            - entity_id: 'sensor.snr_*_freezer_temperature'
              state: '> -13.9'
              options:
                icon: 'mdi:fridge-alert-outline'
                secondary_info: last-changed
                <<: *alert-style
            # fridge temperature too warm (> 6.9 Â°C)
            - entity_id: 'sensor.snr_*_fridge_temperature'
              state: '> 6.9'
              options:
                icon: 'mdi:fridge-alert-outline'
                secondary_info: last-changed
                <<: *alert-style
            # outdoor air quality unhealthy
            - entity_id: sensor.purpleair_aqi_description
              state: '/(Unhealthy|Hazardous)/'
              options:
                name: 'Outdoor Air Quality'
                secondary_info: last-changed
                icon: 'mdi:chemical-weapon'
                <<: *alert-style
            # plant needs water
            - entity_id: 'sensor.plnt_*_soil'
              state: '/(Moisture)/'
              options:
                icon: 'mdi:sprout-outline'
                secondary_info: last-changed
                <<: *alert-plant-style
            # water leak
            - entity_id: 'binary_sensor.snr_*_water_leak'
              state: 'on'
              options:
                icon: 'mdi:water-alert'
                secondary_info: last-changed
                <<: *alert-style
            # weather advisories
            - entity_id: sensor.pitt_meadows_warnings
              # regex matches any string that contains at least one non-space character
              state: '/^(?!\s*$).+/'
              options:
                name: 'Weather'
                icon: 'mdi:weather-cloudy-alert'
                secondary_info: last-changed
                <<: *alert-style
            # garage heater turned off
            - entity_id: sensor.hvac_garage_mode_state
              state: '/Off/'
              options:
                name: 'Garage: Heater'
                icon: 'mdi:fire-off'
                secondary_info: last-changed
                <<: *alert-style
            # always on plugs off (see: group.plugs_always_on)
            - entity_id: '/switch.plg_(crawlspace_deepfreezer|garage_fridge|laundry_washingmachine)/'
              state: 'off'
              options:
                icon: 'mdi:power-plug-off-outline'
                secondary_info: last-changed
                <<: *alert-style
        sort:
          method: name

      # hvac entities active
      - type: 'custom:auto-entities'
        show_empty: false
        card:
          type: entities
          title: 'HVAC'
          <<: *entities-overview-header-style
        filter:
          include:
            # house (ecobee) & garage (sinope)
            - entity_id: '/binary_sensor.hvac_(ecobee|garage)_(cooling|heating)_state/'
              state: 'on'
              options:
                secondary_info: last-changed
            # kids & main bedroom radiators
            - entity_id: '/binary_sensor.(kids|main)_(.*)_heating_state/'
              state: 'on'
              options:
                secondary_info: last-changed
        sort:
          method: name

      # devices that are active
      - type: 'custom:auto-entities'
        show_empty: false
        card:
          type: entities
          title: 'Devices'
          show_header_toggle: false
          <<: *entities-overview-header-style
        filter:
          include:
            # crawlspace
            - entity_id: switch.sw_crawlspace_entrancelight
              state: 'on'
              options:
                name: 'Crawlspace: Entrance'
                icon: 'mdi:lightbulb-outline'
                secondary_info: last-changed
            - entity_id: light.blb_crawlspace_lab
              state: 'on'
              options:
                name: 'Crawlspace: Lab'
                icon: 'mdi:lightbulb-outline'
                secondary_info: last-changed
                <<: *neutral-icon-entity-style
            - entity_id: switch.plg_crawlspace_zbrtr
              state: 'on'
              options:
                name: 'Crawlspace: Locker Dehumidifier'
                icon: 'mdi:water-outline'
                secondary_info: last-changed
            # driveway
            - entity_id: light.group_driveway_lights
              state: 'on'
              options:
                name: 'Driveway'
                icon: 'mdi:coach-lamp'
                secondary_info: last-changed
                <<: *neutral-icon-entity-style
            # family room
            - entity_id: switch.sw_familyroom_ceilinglight
              state: 'on'
              options:
                name: 'Family Room: Ceiling'
                icon: 'mdi:ceiling-light-outline'
                secondary_info: last-changed
            - entity_id: switch.plg_familyroom_cabinetlight
              state: 'on'
              options:
                name: 'Family Room: Cabinet'
                icon: 'mdi:light-recessed'
                secondary_info: last-changed
            - entity_id: switch.sw_familyroom_cornerlight
              state: 'on'
              options:
                name: 'Family Room: Corner'
                icon: 'mdi:light-recessed'
                secondary_info: last-changed
            - entity_id: light.sw_familyroom_walllights
              state: 'on'
              options:
                type: 'custom:slider-entity-row'
                hide_state: true
                name: 'Family Room: Wall Sconce'
                icon: 'mdi:wall-sconce-round-variant'
                secondary_info: last-changed
                <<: *neutral-icon-entity-style
            # garage
            - entity_id: switch.sw_garageceilingmain
              state: 'on'
              options:
                name: 'Garage: Ceiling (Main)'
                icon: 'mdi:lightbulb-fluorescent-tube-outline'
                secondary_info: last-changed
            - entity_id: switch.plg_garagedehumidifier
              state: 'on'
              options:
                name: 'Garage: Dehumidifier'
                icon: 'mdi:water-outline'
                secondary_info: last-changed
            - entity_id: switch.sw_garagesidedoor
              state: 'on'
              options:
                name: 'Garage: Side Door'
                icon: 'mdi:coach-lamp'
                secondary_info: last-changed
            # kitchen
            - entity_id: light.kitchen_ceiling
              state: 'on'
              options:
                name: 'Kitchen: Ceiling'
                icon: 'mdi:light-recessed'
                <<: *neutral-icon-entity-style
                secondary_info: last-changed
            - entity_id: switch.sw_kitchen_sinklight
              state: 'on'
              options:
                name: 'Kitchen: Sink'
                icon: 'mdi:light-recessed'
                secondary_info: last-changed
            - entity_id: light.sw_diningroom_ceilinglight
              state: 'on'
              options:
                type: 'custom:slider-entity-row'
                hide_state: true
                name: 'Kitchen: Table'
                icon: 'mdi:ceiling-light-outline'
                secondary_info: last-changed
                <<: *neutral-icon-entity-style
            - entity_id: switch.plg_kitchen_espressomachine
              state: 'on'
              options:
                name: 'Espresso Machine'
                icon: 'mdi:coffee-maker-outline'
                secondary_info: last-changed
            - entity_id: switch.plg_kitchen_outlet1
              state: 'on'
              options:
                name: 'Kitchen: Baby Monitor'
                icon: 'mdi:speaker'
                secondary_info: last-changed
            # living room
            - entity_id: light.sw_livingroom_ceilinglight
              state: 'on'
              options:
                type: 'custom:slider-entity-row'
                hide_state: true
                name: 'Living Room: Ceiling'
                icon: 'mdi:track-light'
                secondary_info: last-changed
                <<: *neutral-icon-entity-style
            # office
            - entity_id: switch.sw_office_ceilinglight
              state: 'on'
              options:
                name: "Office: Ceiling"
                icon: 'mdi:track-light'
                secondary_info: last-changed
            - entity_id: switch.plg_office_airpurifier
              state: 'on'
              options:
                name: 'Office: Air Purifier'
                icon: 'mdi:air-purifier'
                secondary_info: last-changed
            # main bedroom
            - entity_id: light.sw_mainbedroomceiling
              state: 'on'
              options:
                type: 'custom:slider-entity-row'
                hide_state: true
                name: 'Main Bedroom'
                icon: 'mdi:dome-light'
                secondary_info: last-changed
                <<: *neutral-icon-entity-style
            # kids bedroom
            - entity_id: light.sw_kidsbedroom_ceilinglight
              state: 'on'
              options:
                type: 'custom:slider-entity-row'
                hide_state: true
                name: 'Kids Bedroom: Ceiling'
                icon: 'mdi:dome-light'
                secondary_info: last-changed
                <<: *neutral-icon-entity-style
            - entity_id: light.blb_kidsbedroom_lamp
              state: 'on'
              options:
                type: 'custom:slider-entity-row'
                hide_state: true
                name: 'Kids Bedroom: Lamp'
                icon: 'mdi:lamp-outline'
                secondary_info: last-changed
            # laundry
            - entity_id: switch.plg_laundry_zbrtr
              state: 'on'
              options:
                name: 'Laundry: Dehumidifier'
                icon: 'mdi:water-outline'
                secondary_info: last-changed
            - entity_id: binary_sensor.laundry_washing_machine_state
              state: 'on'
              options:
                name: 'Laundry: Washing Machine'
                icon: 'mdi:washing-machine'
                secondary_info: last-changed
            # porch
            - entity_id: light.group_porch_lights
              state: 'on'
              options:
                name: 'Porch'
                icon: 'mdi:light-recessed'
                secondary_info: last-changed
                <<: *neutral-icon-entity-style
            - entity_id: switch.sw_fronthouseoutlet
              state: 'on'
              options:
                name: 'Front: Outlet'
                icon: 'mdi:power'
                secondary_info: last-changed
            # shed
            - entity_id: switch.sw_shedfan
              state: 'on'
              options:
                name: 'Shed: Fan'
                icon: 'mdi:fan'
                secondary_info: last-changed
            - entity_id: switch.sw_shed_floodlight
              state: 'on'
              options:
                name: 'Shed: Flood'
                icon: 'mdi:light-flood-down'
                secondary_info: last-changed
            - entity_id: switch.plg_utility
              state: 'on'
              options:
                name: 'Shed: Grow Light'
                icon: 'mdi:ceiling-light-outline'
                secondary_info: last-changed
            # stairwell
            - entity_id: light.stairwell_ceiling
              state: 'on'
              options:
                name: 'Stairwell'
                icon: 'mdi:chandelier'
                secondary_info: last-changed
                <<: *neutral-icon-entity-style

      # entertainment devices active
      - type: 'custom:auto-entities'
        show_empty: false
        card:
          type: entities
          title: 'Entertainment'
          <<: *entities-overview-header-style
        filter:
          include:
            # speakers
            - entity_id: 'media_player.*_speaker'
              state: 'playing'
              options:
                secondary_info: last-changed
            # tvs
            - entity_id: switch.living_room_entertainment
              state: 'on'
              options:
                name: 'Living Room: TV'
                icon: 'mdi:television'
                secondary_info: last-changed
        sort:
          method: name

      # doors and windows active
      - type: 'custom:auto-entities'
        show_empty: false
        card:
          type: entities
          title: 'Doors & Windows'
          <<: *entities-overview-header-style
        filter:
          include:
            # doors: zigbee (aqara)
            - entity_id: 'binary_sensor.snr_*door*_contact'
              state: 'on'
              options:
                secondary_info: last-changed
            # doors: tasmota
            - entity_id: binary_sensor.garage_vehicle_door_contact_state
              state: 'on'
              options:
                icon: 'mdi:garage-open-variant'
                secondary_info: last-changed
                tap_action:
                  action: call-service
                  service: cover.toggle
                  service_data:
                    entity_id: cover.garage_door
            # windows: zigbee (aqara)
            - entity_id: 'binary_sensor.snr_*window*_contact'
              state: 'on'
              options:
                secondary_info: last-changed
        sort:
          method: name


  ## ------ SWITCH DASHBAORD ------
  - title: Home
    panel: false
    path: default_view
    icon: 'mdi:home-outline'
    theme: google-dark-theme
    badges: []
    cards:
      # Family Room
      - type: 'custom:vertical-stack-in-card'
        title: 'Family Room'
        <<: *entities-header-style
        cards:
        - type: horizontal-stack
          cards:
            - type: entities
              show_header_toggle: false
              <<: *entities-style
              entities:
                # display cabinet
                - entity: switch.plg_familyroom_cabinetlight
                  name: Cabinet
                  icon: 'mdi:light-recessed'
                  state_color: true
                # display corner
                - entity: switch.sw_familyroom_cornerlight
                  name: Corner
                  icon: 'mdi:light-recessed'
                  state_color: true
                # wall sconce
                - entity: light.sw_familyroom_walllights
                  name: 'Wall Sconce'
                  icon: 'mdi:wall-sconce-round-variant'
            - type: entities
              show_header_toggle: false
              <<: *entities-style
              entities:
                # ceiling light
                - entity: switch.sw_familyroom_ceilinglight
                  name: Ceiling
                  icon: 'mdi:ceiling-light-outline'
                  state_color: true
                # stairwell chandelier
                - entity: light.stairwell_ceiling
                  name: Stairwell
                  icon: 'mdi:chandelier'
                  state_color: true


      # Kitchen
      - type: 'custom:vertical-stack-in-card'
        title: 'Kitchen'
        <<: *entities-header-style
        cards:
        - type: horizontal-stack
          cards:
            - type: entities
              show_header_toggle: false
              <<: *entities-style
              entities:
                # baby monitor
                - entity: switch.plg_kitchen_outlet1
                  name: 'Baby Monitor'
                  icon: 'mdi:speaker'
                  state_color: true
                # espresso machine
                - entity: switch.plg_kitchen_espressomachine
                  name: 'Espresso'
                  icon: 'mdi:coffee-maker-outline'
                  state_color: true
                # sink
                - entity: switch.sw_kitchen_sinklight
                  name: Sink
                  icon: 'mdi:light-recessed'
                  state_color: true
            - type: entities
              show_header_toggle: false
              <<: *entities-style
              entities:
                # ceiling light
                - entity: light.kitchen_ceiling
                  name: 'Ceiling'
                  icon: 'mdi:light-recessed'
                  state_color: true
                # speaker
                - entity: switch.plg_kitchen_speaker
                  name: Speaker
                  icon: 'mdi:speaker'
                  state_color: true
                # dining table
                - entity: light.sw_diningroom_ceilinglight
                  name: 'Table'
                  icon: 'mdi:ceiling-light-outline'

      # Living Room
      - type: 'custom:vertical-stack-in-card'
        title: 'Living Room'
        <<: *entities-header-style
        cards:
        - type: horizontal-stack
          cards:
          - type: entities
            <<: *entities-style
            entities:
              # ceiling light
              - entity: light.sw_livingroom_ceilinglight
                name: 'Ceiling'
                icon: 'mdi:track-light'
                state_color: true
          - type: entities
            <<: *entities-style
            entities:
              # entertainment
              - entity: switch.living_room_entertainment
                name: 'TV'
                icon: 'mdi:television'
                state_color: true

      # Office
      - type: 'custom:vertical-stack-in-card'
        title: 'Office'
        <<: *entities-header-style
        cards:
        - type: horizontal-stack
          cards:
            - type: entities
              <<: *entities-style
              entities:
              # air purifier
              - entity: switch.plg_office_airpurifier
                name: 'Air Purifier'
                icon: 'mdi:air-purifier'
                state_color: true
            - type: entities
              <<: *entities-style
              entities:
              # ceiling light
              - entity: switch.sw_office_ceilinglight
                name: 'Ceiling'
                icon: 'mdi:track-light'
                state_color: true

      # Main Bedroom
      - type: 'custom:vertical-stack-in-card'
        title: 'Main Bedroom'
        <<: *entities-header-style
        cards:
        - type: horizontal-stack
          cards:
            - type: entities
              show_header_toggle: false
              <<: *entities-style
              entities:
                # ceiling light
                - entity: light.sw_mainbedroomceiling
                  name: 'Ceiling'
                  icon: 'mdi:dome-light'
                  state_color: true
            - type: entities
              show_header_toggle: false
              <<: *entities-style
              entities:
                # heater
                - entity: switch.plg_mainbedroomheater
                  name: 'Heater'
                  icon: 'mdi:radiator'
                  state_color: true

      # Kids Bedroom
      - type: 'custom:vertical-stack-in-card'
        title: 'Kids Bedroom'
        <<: *entities-header-style
        cards:
        - type: horizontal-stack
          cards:
            - type: entities
              show_header_toggle: false
              <<: *entities-style
              entities:
                # ceiling light
                - entity: light.sw_kidsbedroom_ceilinglight
                  name: 'Ceiling'
                  icon: 'mdi:dome-light'
                  state_color: true
            - type: entities
              show_header_toggle: false
              # not using entities-style anchor to allow for some extra padding
              # for the rgb-light-card.
              card_mod:
                style: |
                  :host .card-content {
                    padding: 0px 10px 10px 10px;
                  }
                  ha-card {
                    box-shadow: none;
                  }
              entities:
                # lamp light bulb on/off control
                - entity: light.blb_kidsbedroom_lamp
                  name: 'Lamp'
                  icon: 'mdi:lamp-outline'
                  state_color: true
                # lamp light bulb color quick picker
                - type: 'custom:rgb-light-card'
                  entity: light.blb_kidsbedroom_lamp
                  size: 20
                  justify: center
                  colors:
                    # red
                    - rgb_color:
                        - 255
                        - 0
                        - 0
                      effect: 'solid'
                      transition: 1
                    # orange
                    - rgb_color:
                        - 255
                        - 128
                        - 0
                      effect: 'solid'
                      transition: 1
                    # green
                    - rgb_color:
                        - 0
                        - 255
                        - 0
                      effect: 'solid'
                      icon_color: '#33ff33'
                      transition: 1
                    # blue
                    - rgb_color:
                        - 0
                        - 0
                        - 255
                      effect: 'solid'
                      icon_color: '#3333ff'
                      transition: 1
                    # purple
                    - rgb_color:
                        - 128
                        - 0
                        - 255
                      effect: 'solid'
                      icon_color: '#9933ff'

      # Laundry
      - type: 'custom:vertical-stack-in-card'
        title: 'Laundry'
        <<: *entities-header-style
        cards:
        - type: horizontal-stack
          cards:
            - type: entities
              show_header_toggle: false
              <<: *entities-style
              entities:
                # dehumidifier
                - entity: switch.plg_laundry_zbrtr
                  name: 'Dehumidifier'
                  icon: 'mdi:water-outline'
                  state_color: true
            - type: 'custom:button-card'
              <<: *entities-style
              color_type: blank

      # Garage
      - type: 'custom:vertical-stack-in-card'
        title: 'Garage'
        <<: *entities-header-style
        cards:
        - type: horizontal-stack
          cards:
            # vehicle door opener
            - type: 'custom:button-card'
              entity: cover.garage_door
              name: 'Vehicle Door'
              tap_action:
                action: toggle
              confirmation:
                text: '[[[ return `Are you sure you want to toggle the Garage Door?` ]]]'
              state:
                - value: 'open'
                  color: 'var(--paper-item-icon-active-color)'
                - value: 'closed'
                  color: 'var(--paper-item-icon-color)'
              styles:
                card:
                  - font-size: 1.0em
                  - height: 100px
              style: |
                ha-card {
                  box-shadow: none;
                }
              entities:
            # switches
            - type: entities
              show_header_toggle: false
              <<: *entities-style
              entities:
                # ceiling light
                - entity: switch.sw_garageceilingmain
                  name: 'Ceiling'
                  icon: 'mdi:lightbulb-fluorescent-tube-outline'
                  state_color: true
                # dehumidifier
                - entity: switch.plg_garagedehumidifier
                  name: 'Dehumidifier'
                  icon: 'mdi:water-outline'
                  state_color: true
                # side door light
                - entity: switch.sw_garagesidedoor
                  name: 'Side Door'
                  icon: 'mdi:coach-lamp'
                  state_color: true

      # Crawlspace
      - type: 'custom:vertical-stack-in-card'
        title: 'Crawlspace'
        <<: *entities-header-style
        cards:
        - type: horizontal-stack
          cards:
            - type: entities
              show_header_toggle: false
              <<: *entities-style
              entities:
                # entrance light
                - entity: switch.sw_crawlspace_entrancelight
                  name: 'Entrance'
                  icon: 'mdi:lightbulb-outline'
                  state_color: true
                # locker heater (dehumidifier)
                - entity: switch.plg_crawlspace_zbrtr
                  name: 'Locker Dehumidifier'
                  icon: 'mdi:water-outline'
                  state_color: true
            - type: entities
              show_header_toggle: false
              <<: *entities-style
              entities:
                # lab light
                - entity: light.blb_crawlspace_lab
                  name: 'Lab'
                  icon: 'mdi:lightbulb-outline'
                  state_color: true


      # Outdoor (Front)
      - type: 'custom:vertical-stack-in-card'
        title: 'Outside'
        <<: *entities-header-style
        cards:
        - type: horizontal-stack
          cards:
            - type: entities
              show_header_toggle: false
              <<: *entities-style
              entities:
                # driveway
                - entity: light.group_driveway_lights
                  name: Driveway
                  icon: 'mdi:coach-lamp'
                  state_color: true
                # front outlet
                - entity: switch.sw_fronthouseoutlet
                  name: 'Driveway Outlet'
                  icon: 'mdi:power'
                  state_color: true
            - type: entities
              show_header_toggle: false
              <<: *entities-style
              entities:
                # porch lights
                - entity: light.group_porch_lights
                  name: Porch
                  icon: 'mdi:light-recessed'
                  state_color: true

      # Shed
      - type: 'custom:vertical-stack-in-card'
        title: 'Shed'
        <<: *entities-header-style
        cards:
        - type: horizontal-stack
          cards:
            - type: entities
              show_header_toggle: false
              <<: *entities-style
              entities:
                # ventilation fan
                - entity: switch.sw_shedfan
                  name: Fan
                  icon: 'mdi:fan'
                  state_color: true
                # grow light
                - entity: switch.plg_utility
                  name: 'Grow Light'
                  icon: 'mdi:ceiling-light-outline'
                  state_color: true
            - type: entities
              show_header_toggle: false
              <<: *entities-style
              entities:
                # flood light
                - entity: switch.sw_shed_floodlight
                  name: Flood
                  icon: 'mdi:light-flood-down'
                  state_color: true


  ## ------ CLIMATE DASHBOARD ------
  - title: Climate
    path: climate
    icon: 'mdi:home-thermometer-outline'
    theme: google-dark-theme
    badges: []
    cards:
      # HOUSE INDOOR CLIMATE CARDS
      - type: 'custom:vertical-stack-in-card'
        title: 'House'
        <<: *entities-header-style
        cards:
        ## HOUSE THERMOSTAT 
        - type: 'custom:simple-thermostat'
          entity: climate.amazon
          <<: *thermostat-style
          layout:
            step: row
          header: false
          control: false
          hide:
            state: true
            temperature: true
          sensors:
            - entity: sensor.hvac_ecobee_indoor_average_temperature
              name: 'Temperature'
            - entity: sensor.indoor_mean_humidity
              name: 'Humidity'
            - entity: sensor.hvac_ecobee_time_on_today
              attribute: value
              name: 'Runtime'

        ## INDOOR TEMPERATURE CARDS
        # row 1
        - type: horizontal-stack
          cards:
          # upstairs hallway
          - type: 'custom:button-card'
            entity: sensor.uptairs_hallway_temperature
            name: 'Upstairs Hall'
            show_state: true
            show_icon: false
            <<: *climate-button-style

          # main bedroom
          - type: 'custom:button-card'
            entity: sensor.main_bedroom_mean_temperature_calculation
            name: 'Main Bedroom'
            show_state: true
            show_icon: false
            <<: *climate-button-style

          # kids room
          - type: 'custom:button-card'
            entity: sensor.kids_bedroom_temperature_1_decimal
            name: 'Kids Bedroom'
            show_state: true
            show_icon: false
            <<: *climate-button-style

          # spare bedroom
          - type: 'custom:button-card'
            entity: sensor.spare_bedroom_temperature_1_decimal
            name: 'Spare Bedroom'
            show_state: true
            show_icon: false
            <<: *climate-button-style

        # TEMPERATURE BUTTONS
        # row 2
        - type: horizontal-stack
          cards:
          # kitchen
          - type: 'custom:button-card'
            entity: sensor.kitchen_mean_temperature_calculation
            name: 'Kitchen'
            show_state: true
            show_icon: false
            <<: *climate-button-style

          # family room
          - type: 'custom:button-card'
            entity: sensor.family_room_temperature
            name: 'Family Room'
            show_state: true
            show_icon: false
            <<: *climate-button-style

          # office
          - type: 'custom:button-card'
            entity: sensor.office_temperature_1_decimal
            name: Office
            show_state: true
            show_icon: false
            <<: *climate-button-style

          # crawlspace
          - type: 'custom:button-card'
            entity: sensor.crawlspace_temperature_1_decimal
            name: Crawlspace
            show_state: true
            show_icon: false
            <<: *climate-button-style

        # INDOOR TEMPERATURE GRAPHS
        - type: 'custom:mini-graph-card'
          show:
            extrema: false
            fill: fade
            icon: false
            labels: hover
            labels_secondary: hover
            name: false
            state: false
          height: 100
          line_width: 1
          hours_to_show: 24
          points_per_hour: 3
          group: true
          lower_bound_secondary: 35
          upper_bound_secondary: 70
          font_size: 85
          entities:
            # temerature in downstairs family room
            - entity: sensor.family_room_temperature
              name: Downstairs
              show_fill: false
              show_points: false
              color: '#eb3b5a'
            # temerature at upstairs hallway ecobee remote sensor
            - entity: sensor.uptairs_hallway_temperature
              name: Upstairs
              show_fill: false
              show_points: false
              color: '#e6b800'
            # temerature at crawlspace aqara sensor
            - entity: sensor.crawlspace_temperature_1_decimal
              name: Crawlspace
              show_fill: false
              show_points: false
              color: '#21b064'
            # humidity (mean from all climate sensors)
            - entity: sensor.indoor_mean_humidity
              name: Humidity
              show_fill: false
              state_adaptive_color: true
              color: '#5f9bea'
              show_points: false
              y_axis: secondary

        # INDOOR HVAC FUNCTION GRAPHS
        - type: 'custom:mini-graph-card'
          show:
            extrema: false
            fill: fade
            icon: false
            labels: hover
            labels_secondary: hover
            name: false
            state: false
          height: 20
          line_width: 1
          hours_to_show: 24
          points_per_hour: 60
          group: true
          entities:
            # cooling on/off
            - entity: binary_sensor.hvac_ecobee_cooling_state
              name: Cooling
              color: '#71b7f4'
              show_legend: false
              show_line: false
              show_points: false
            # heating on/off
            - entity: binary_sensor.hvac_ecobee_heating_state
              name: Heating
              color: '#ffad33'
              show_legend: false
              show_line: false
              show_points: false
            # hvac fan on/off
            - entity: binary_sensor.hvac_ecobee_fan_state
              name: Fan
              color: '#ffffff'
              show_legend: true
              show_line: false
              show_points: false
          state_map:
            - value: 'off'
            - value: 'on'

      ## GARAGE CLIMATE CARDS
      - type: 'custom:vertical-stack-in-card'
        title: 'Garage'
        <<: *entities-header-style
        cards:
        ## GARAGE THERMOSTAT 
        - type: 'custom:simple-thermostat'
          entity: climate.hvac_garagethermostat
          <<: *thermostat-style
          layout:
            step: row
          header: false
          control: false
          hide:
            state: true
            temperature: true
          sensors:
            - entity: sensor.garage_mean_temperature_calculation
              name: 'Temperature'
            - entity: sensor.garage_climate_humidity_rounded
              name: 'Humidity'

        # GARAGE TEMPERATURE GRAPHS
        - type: 'custom:mini-graph-card'
          show:
            extrema: false
            icon: false
            labels: hover
            labels_secondary: hover
            name: false
            state: false
          height: 60
          line_width: 1
          hours_to_show: 24
          points_per_hour: 4
          lower_bound_secondary: 30
          upper_bound_secondary: 75
          group: true
          <<: *temp-graph-color_thresholds
          entities:
            # temerature
            - entity: sensor.garage_mean_temperature_calculation
              name: "Temperature"
              show_fill: false
              show_legend: false
              state_adaptive_color: true
            # humidity
            - entity: sensor.garage_climate_humidity_rounded
              name: Humidity
              line_width: 1
              show_legend: false
              show_fill: false
              state_adaptive_color: true
              color: '#5f9bea'
              y_axis: secondary

        # GARAGE FUNCTION GRAPHS
        - type: 'custom:mini-graph-card'
          show:
            extrema: false
            fill: fade
            icon: false
            labels: hover
            labels_secondary: hover
            name: false
            state: false
          height: 20
          line_width: 1
          hours_to_show: 24
          points_per_hour: 60
          group: true
          entities:
            # garage car door opened/closed
            - entity: binary_sensor.garage_vehicle_door_contact_state
              name: 'Vehicle Door'
              color: '#ffffff'
              show_legend: true
              show_line: false
              show_points: false
            # garage heater on/off
            - entity: binary_sensor.hvac_garage_heating_state
              name: Heating
              color: '#ffad33'
              show_legend: false
              show_line: false
              show_points: false
            # garage dehumidifier on/off
            - entity: binary_sensor.garage_dehumidifier_state
              name: 'Dehumidifier'
              color: '#71b7f4'
              show_legend: false
              show_line: false
              show_points: false
          state_map:
            - value: 'off'
            - value: 'on'

      ## SHED CLIMATE CARDS
      - type: 'custom:vertical-stack-in-card'
        title: 'Shed'
        <<: *entities-header-style
        cards:
        - type: horizontal-stack
          cards:
          # shed temperature
          - type: 'custom:button-card'
            entity: sensor.shed_temperature_1_decimal
            name: Temperature
            show_state: true
            show_icon: false
            <<: *graph-button-card-style
          # shed humidity
          - type: 'custom:button-card'
            entity: sensor.shed_humidity_rounded
            name: Humidity
            show_state: true
            show_icon: false
            <<: *graph-button-card-style

        # SHED TEMPERATURE GRAPH CARD
        - type: 'custom:mini-graph-card'
          show:
            extrema: false
            icon: false
            labels: hover
            labels_secondary: hover
            name: false
            state: false
          height: 60
          line_width: 1
          hours_to_show: 24
          points_per_hour: 4
          lower_bound_secondary: 25
          upper_bound_secondary: 90
          group: true
          <<: *temp-graph-color_thresholds
          entities:
            # temerature
            - entity: sensor.shed_temperature_1_decimal
              name: Temperature
              show_fill: false
              show_legend: false
              state_adaptive_color: true
            # humidity
            - entity: sensor.shed_humidity_rounded
              name: Humidity
              line_width: 1
              show_legend: false
              show_fill: false
              state_adaptive_color: true
              color: '#5f9bea'
              y_axis: secondary

      ## OUTDSIDE CLIMATE CARDS
      - type: 'custom:vertical-stack-in-card'
        title: 'Outside'
        <<: *entities-header-style
        cards:
        # WEATHER
        - type: 'custom:simple-weather-card'
          entity: weather.pitt_meadows
          name: " "
          custom:
            - humidity: sensor.snr_outside_humidity
            - temp: sensor.snr_outside_temperature
          primary_info:
            - humidity
            - pressure
          secondary_info:
            - precipitation_probability
            - wind_speed
          card_mod:
            style: |
              .weather__info__title {
                font-size: 20px;
              }
              ha-card.type-custom-simple-weather-card {
                padding: 10px 10px 5px 5px;
              }

        # AIR QUALITY (FROM PURPLEAIR DEVICE)
        - type: horizontal-stack
          cards:
          # AQI
          - type: 'custom:button-card'
            entity: sensor.purpleair
            name: ' '
            show_state: true
            show_icon: false
            <<: *graph-button-card-style
          # blank card to add spacing
          - type: 'custom:button-card'
            color_type: blank
            styles:
              card:
                - width: 25px
            style: |
              ha-card {
                box-shadow: none;
              }
          # pm 2.5
          - type: 'custom:button-card'
            entity: sensor.purpleair_pm_2_5
            name: 'PM 2.5'
            show_state: true
            show_icon: false
            <<: *graph-button-card-style
          # pm 10
          - type: 'custom:button-card'
            entity: sensor.purpleair_pm_10
            name: 'PM 10'
            show_state: true
            show_icon: false
            <<: *graph-button-card-style
        - type: 'custom:mini-graph-card'
          entities:
            - sensor.purpleair
          unit: AQI
          name: AQI
          hour24: true
          show:
              extrema: false
              fill: fade
              icon: false
              labels: hover
              labels_secondary: hover
              name: false
              state: false
          height: 60
          line_width: 1
          points_per_hour: 6
          hours_to_show: 24
          color_thresholds_transition: hard
          color_thresholds:
              - value: 0
                color: '#24b300'
              - value: 50
                color: '#b3b300'
              - value: 100
                color: '#a54f0d'
              - value: 150
                color: '#a21c10'
              - value: 200
                color: '#8c1a4b'
              - value: 250
                color: '#731425'


  ## ------ BATTERY DASHBOARD ------
  - title: Battery
    path: battery
    icon: 'mdi:battery-outline'
    theme: google-dark-theme
    badges: []
    cards:
      # Climate Sensors
      - type: 'custom:battery-state-card'
        title: 'Climate Sensors'
        <<: *battery-state-color_gradient
        <<: *battery-state-style
        tap_action: more-info
        sort_by_level: 'asc'
        filter:
          include:
            - name: entity_id
              value: 'sensor.snr_*climate_battery'

      # Contact Sensors
      - type: 'custom:battery-state-card'
        title: 'Contact Sensors'
        <<: *battery-state-color_gradient
        <<: *battery-state-style
        tap_action: more-info
        sort_by_level: 'asc'
        filter:
          include:
            - name: entity_id
              value: 'sensor.snr_*contact_battery'

      # Leak Sensors
      - type: 'custom:battery-state-card'
        title: 'Leak Sensors'
        <<: *battery-state-color_gradient
        <<: *battery-state-style
        tap_action: more-info
        sort_by_level: 'asc'
        filter:
          include:
            - name: entity_id
              value: 'sensor.snr_*leak_battery'

      # Motion Sensors
      - type: 'custom:battery-state-card'
        title: 'Motion Sensors'
        <<: *battery-state-color_gradient
        <<: *battery-state-style
        tap_action: more-info
        sort_by_level: 'asc'
        filter:
          include:
            - name: entity_id
              value: 'sensor.snr_*motion_battery'

      # Plant Sensors
      - type: 'custom:battery-state-card'
        title: 'Plant Sensors'
        <<: *battery-state-color_gradient
        <<: *battery-state-style
        tap_action: more-info
        sort_by_level: 'asc'
        filter:
          include:
            - name: entity_id
              value: 'sensor.plnt_*_battery'

      # Remote Controls
      - type: 'custom:battery-state-card'
        title: 'Remotes'
        <<: *battery-state-color_gradient
        <<: *battery-state-style
        tap_action: more-info
        sort_by_level: 'asc'
        filter:
          include:
            - name: entity_id
              value: 'sensor.rmt_*remote_battery'

      # Temperature Sensors
      - type: 'custom:battery-state-card'
        title: 'Temperature Sensors'
        <<: *battery-state-color_gradient
        <<: *battery-state-style
        tap_action: more-info
        sort_by_level: 'asc'
        filter:
          include:
            - name: entity_id
              value: 'binary_sensor.snr_*_temperature_battery_low'
        state_map:
          - from: 'off'
            to: 100
          - from: 'on'
            to: 20

      # Vibration Sensors
      - type: 'custom:battery-state-card'
        title: 'Vibration Sensors'
        <<: *battery-state-color_gradient
        <<: *battery-state-style
        tap_action: more-info
        sort_by_level: 'asc'
        filter:
          include:
            - name: entity_id
              value: 'sensor.snr_*vibration_battery'
